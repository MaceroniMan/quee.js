const __q__={dbg:{cbox:!1,commands_enabled:!0},globalSprites:[],globalImages:[],globalCallbacks:{key:{},mouse_move:function(){},mouse_click:function(){}},keyCallback:function(e){locale.quee.last_pressed_key=e.key,locale.quee.key_pressed=!0,e.key in __q__.globalCallbacks.key&&__q__.globalCallbacks.key[e.key](e.key),"~~"in __q__.globalCallbacks.key&&__q__.globalCallbacks.key["~~"](e.key),"~-"in __q__.globalCallbacks.key&&e.key in[1,2,3,4,5,6,7,8,9,0]&&__q__.globalCallbacks.key["~-"](e.key)},removeSprites:function(e){var i=__q__.globalSprites.map(function(e){return e}).indexOf(e);__q__.globalSprites.splice(i,1)},onMove:function(e){var i=document.getElementById("quee_canvas"),t=0,s=0;if(i.offsetParent)do{t+=i.offsetLeft,s+=i.offsetTop}while(i=i.offsetParent);var n=e.pageX-t,o=e.pageY-s;locale.quee.mouse_position=[n,o],__q__.globalCallbacks.mouse_move(n,o)},onClick(e){var i=document.getElementById("quee_canvas"),t=0,s=0;if(i.offsetParent)do{t+=i.offsetLeft,s+=i.offsetTop}while(i=i.offsetParent);var n=e.pageX-t,o=e.pageY-s;__q__.globalCallbacks.mouse_click(n,o),locale.quee.mouse_clicked=!1,locale.quee.last_mouse_click=[n,o];var _=[];for(spritenum in __q__.globalSprites)if(sprite=__q__.globalSprites[spritenum],0==sprite.__world.hidden){const[e,i,t,s]=__q__.getDims(sprite),[l,a,r,c]=[n,o,1,1];sprite.click&&(l>t+e||e>r+l||a>s+i||i>c+a||_.push([sprite.__onclick_callback,n,o]))}for(spritecallback in _)_[spritecallback][0](_[spritecallback][1],_[spritecallback][2])},getDims:function(e){var i=e.image.height*e.scale,t=e.image.width*e.scale*e.image.height/e.image.width;return[e.x,e.y,t,i]},collided:function(e,i){const[t,s,n,o]=__q__.getDims(e),[_,l,a,r]=__q__.getDims(i);return!(_>n+t||t>a+_||l>o+s||s>r+l)},ifCollision:function(e){var i=[];for(sprite in e)if("sprite"==e[sprite].__type&&0==e[sprite].__world.hidden){if(0==e[sprite].clip)continue;for(osprites in e)if("sprite"==e[osprites].__type){if(osprites==sprite)break;0==e[osprites].clip||__q__.collided(e[sprite],e[osprites])&&i.push([e[sprite],e[osprites]])}}return i}};var locale={quee:{last_mouse_click:[],last_pressed_key:"",mouse_position:[],mouse_clicked:!1,key_pressed:!1}},VERSION="0.7";console.log("using quee.js version: "+VERSION),document.onkeydown=__q__.keyCallback,document.onkeyup=function(){locale.quee.key_pressed=!1},document.getElementById("quee_canvas").addEventListener("mouseup",__q__.onClick,!1),document.getElementById("quee_canvas").addEventListener("mousedown",function(){locale.quee.mouse_clicked=!0},!1),document.getElementById("quee_canvas").addEventListener("mousemove",__q__.onMove,!1);const quee_window={Console:{Error:function(e){console.error("[quee.js error] "+e)},Warning:function(e){console.warn("[quee.js warning] "+e)},Info:function(e){console.info("[quee.js info] "+e)}},Cookies:{SetCookie:function(e,i){document.cookie=e+"="+i+";"},GetCookie:function(e){for(var i=e+"=",t=decodeURIComponent(document.cookie).split(";"),s=0;s<t.length;s++){for(var n=t[s];" "==n.charAt(0);)n=n.substring(1);if(0==n.indexOf(i))return n.substring(i.length,n.length)}return""}},Title:function(e){document.title=e},Canvas:function(e=null,i=null){null!=e&&null!=i?(document.getElementById("quee_canvas").width=e,document.getElementById("quee_canvas").width=i):null!=e&&null==i?document.getElementById("quee_canvas").width=e:null==e&&null!=i?document.getElementById("quee_canvas").height=i:(document.getElementById("quee_canvas").width=window.innerWidth,document.getElementById("quee_canvas").height=window.innerHeight)},Stopwatch:{watch:function(){this.__starttime=Math.floor(Date.now()),this.__offset=0,this.paused=!1,this.__pausedtime=0},currenttime:function(e){return function(){return e.__paused?e.__pausedtime-e.__starttime-e.__offset:(temptime=Math.floor(Date.now()),temptime-e.__starttime-e.__offset)}},pause:function(e){return function(){e.__paused?(temptime=Math.floor(Date.now()),e.__paused=!1,e.__offset+=temptime-e.__pausedtime):(e.__paused=!0,e.__pausedtime=Math.floor(Date.now()))}}}},quee_image={LoadImage:function(e,i){return new Promise((t,s)=>{i in __q__.globalImages&&quee_window.Console.Warning("the image: "+i+" already exists");var n=new Image;n.setAttribute("crossOrigin","anonymous"),n.src=e,n.onload=function(){__q__.globalImages[i]=n,quee_window.Console.Info("the image: "+i+" is loaded"),t()}})},LoadImages:async function(e,i){for(image in e)await quee_image.LoadImage(e[image],image);i()}},quee_input={Key:{Bind:function(e,i){e in __q__.globalCallbacks.key&&quee_window.Console.Warning("The keybind: "+e+" is already set."),__q__.globalCallbacks.key[e]=i},Up:"ArrowUp",Down:"ArrowDown",Left:"ArrowLeft",Right:"ArrowRight",PgUp:"PageUp",PgDown:"PageDown",Caps:"CapsLock",Num:"NumLock",Scrl:"ScrollLock",Back:"Backspace",Esc:"Escape",Ctrl:"Control",CxtMnu:"ContextMenu",ALL:"~~",NUMS:"~-"},Mouse:{Move:function(e){__q__.globalCallbacks.mouse_move=e},Click:function(e){__q__.globalCallbacks.mouse_click=e}}},quee_ui={__canvas:document.getElementById("quee_canvas"),Move:{Up:function(e,i=10){return"world"==e.__type?function(){0==e.hidden&&(e.y-=i,e.draw())}:"sprite"==e.__type?function(){0==e.__world.hidden&&(e.y-=i,e.__backward=[0,i],e.__world.draw())}:function(){0==e.__world.hidden&&(e.y-=i,e.__world.draw())}},Down:function(e,i=10){return"world"==e.__type?function(){0==e.hidden&&(e.y+=i,e.draw())}:"sprite"==e.__type?function(){0==e.__world.hidden&&(e.y+=i,e.__backward=[0,-i],e.__world.draw())}:function(){0==e.__world.hidden&&(e.y+=i,e.__world.draw())}},Right:function(e,i=10){return"world"==e.__type?function(){0==e.hidden&&(e.x+=i,e.draw())}:"sprite"==e.__type?function(){0==e.__world.hidden&&(e.x+=i,e.__backward=[-i,0],e.__world.draw())}:function(){0==e.__world.hidden&&(e.x+=i,e.__world.draw())}},Left:function(e,i=10){return"world"==e.__type?function(){0==e.hidden&&(e.x-=i,e.draw())}:"sprite"==e.__type?function(){0==e.__world.hidden&&(e.x-=i,e.__backward=[i,0],e.__world.draw())}:function(){0==e.__world.hidden&&(e.x-=i,e.__world.draw())}}},Delete:function(e,i=!0){return i?function(){e.__exist=!1,e.__world.draw()}:function(){e.__exist=!1}},Visibility:function(e,i){if("world"==e.__type){if(1==i)return function(){e.hidden=!1,e.draw()};if(0==i)return function(){e.hidden=!0,e.clear()};quee_window.Console.Error("visibility must be true or false")}else quee_window.Console.Error("cannot hide non-world object")},Sprite:function(e,i,t={}){"scale"in t||(t.scale=1),"clip"in t||(t.clip=!0),"click"in t||(t.click=!0),this.x=50,this.y=50,this.scale=t.scale,this.clip=t.clip,this.click=t.click,this.image=null,this.__collision_callback=function(){},this.__onclick_callback=function(){},this.__backward=[0,0],this.__world=e,this.__exist=!0,this.__type="sprite",this.__collided=!1,i in __q__.globalImages?this.image=__q__.globalImages[i]:quee_window.Console.Error("The image: "+i+" does not exist!"),this.__world.__add(this),__q__.globalSprites.push(this),this.Collision=function(e){this.__collision_callback=e},this.ChangeImage=function(e){e in __q__.globalImages?this.image=__q__.globalImages[e]:quee_window.Console.Error("The image: "+e+" does not exist!")},this.OnClick=function(e){this.click?this.__onclick_callback=e:quee_window.Console.Warning("OnClick will not be called, 'click' property is false")},this.Dims=function(){if(null==this.image)return[0,0];var e=this.image.height*this.scale;return[this.image.width*this.scale*this.image.height/this.image.width,e]},this.Goto=function(e,i){this.x=e,this.y=i,this.__world.draw()}},Text:function(e,i,t={}){"size"in t||(t.size=30),"font"in t||(t.font="Arial"),this.x=50,this.y=50,this.text=i,this.size=t.size,this.font=t.font,this.__exist=!0,this.__world=e,this.__type="text",this.__world.__add(this),this.Goto=function(e,i){this.x=e,this.y=i,this.__world.draw()}},World:function(){quee_window.Console.Info("world created"),this.__sprites=[],this.maxspritenum=400,this.hidden=!1,this.x=0,this.y=0,this.__type="world",this.__add=function(e){this.__sprites.length>this.maxspritenum?quee_window.Console.Error("Cannot load more sprites, maximum number reached: "+this.maxspritenum.toString()):(this.__sprites.length>Math.round(.75*this.maxspritenum)&&quee_window.Console.Warning("Nearing max sprites number: "+this.maxspritenum.toString()),this.__sprites.push(e),quee_window.Console.Info("Loaded: "+e.__type+" object"))},this.draw=function(){if(0==this.hidden){this.clear(),ctx=quee_ui.__canvas.getContext("2d");var e=__q__.ifCollision(this.__sprites);for(sprite in this.__sprites)this.__sprites[sprite].__collided=!1;for(collision in e)e[collision][0].__collided||(e[collision][0].__collision_callback(e[collision][1]),e[collision][0].x+=e[collision][0].__backward[0],e[collision][0].y+=e[collision][0].__backward[1],e[collision][0].__collided=!0),e[collision][1].__collided||(e[collision][1].__collision_callback(e[collision][0]),e[collision][1].x+=e[collision][1].__backward[0],e[collision][1].y+=e[collision][1].__backward[1],e[collision][1].__collided=!0);var i=[];for(spritenum in this.__sprites)if(0==this.__sprites[spritenum].__exist)"sprite"==this.__sprites[spritenum].__type&&__q__.removeSprites(this.__sprites[spritenum]);else if(i.push(this.__sprites[spritenum]),sprite=this.__sprites[spritenum],"text"==sprite.__type)ctx.font=sprite.size.toString()+"px "+sprite.font,ctx.fillText(sprite.text,sprite.x+this.x,sprite.y+this.y);else{const[e,i,t,s]=__q__.getDims(sprite);(e>quee_ui.__canvas.width-t-t+t||t>t+e||i>quee_ui.__canvas.height-s-s+s||s>s+i)&&(sprite.__collision_callback(quee_ui.__canvas),sprite.x+=sprite.__backward[0],sprite.y+=sprite.__backward[1]),ctx.drawImage(sprite.image,sprite.x+this.x,sprite.y+this.y,sprite.image.height*sprite.scale,sprite.image.width*sprite.scale*sprite.image.height/sprite.image.width),__q__.dbg.cbox&&ctx.strokeRect(sprite.x+this.x,sprite.y+this.y,sprite.image.height*sprite.scale,sprite.image.width*sprite.scale*sprite.image.height/sprite.image.width)}this.__sprites=i}else this.clear()},this.clear=function(){ctx=quee_ui.__canvas.getContext("2d"),ctx.clearRect(0,0,quee_ui.__canvas.width,quee_ui.__canvas.height)},this.Goto=function(e,i){this.x=e,this.y=i,this.__world.draw()}}};function quee_cmd(e="",i={}){if(__q__.dbg.commands_enabled){var t=e.split(" ");if("dbg"==t[0]){if("cbox"==t[1])return __q__.dbg.cbox?(__q__.dbg.cbox=!1,"quee debug cbox | set to false"):(__q__.dbg.cbox=!0,"quee debug cbox | set to true");if("mximnm"==t[1])return"wld"in i?"maxspritenum"in i.wld?"quee debug msimnm | "+i.wld.maxspritenum+" sprites":"quee debug msimnm | wld argument must be a valid world":"quee debug msimnm | args must contain a wld tag";if("clearsp"==t[1])return"wld"in i?"__sprites"in i.wld?(i.wld.__sprites=[],"quee debug clearsp | sprites cleared"):"quee debug clearsp | wld argument must be a valid world":"quee debug clearsp | args must contain a wld tag"}else{if("disablecommands"==t[0])return __q__.dbg.commands_enabled=!1,"quee disablecommands | commands disabled";if(""==t[0])return"quee | empty command"}return"quee | command error"}return"quee | cannot use commands, disabled"}