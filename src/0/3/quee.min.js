var __callbacks={key:{},mouse_move:function(){},mouse_click:function(){}},__images={},__sprites=[],locale={quee:{last_mouse_click:[],last_pressed_key:"",mouse_position:[],mouse_clicked:!1}},VERSION="0.3";function __key_callback(e){locale.quee.last_pressed_key=e.key,e.key in __callbacks.key&&__callbacks.key[e.key](e.key),"~~"in __callbacks.key&&__callbacks.key["~~"](e.key)}function __onMove(e){var i=document.getElementById("quee_canvas"),t=0,s=0;if(i.offsetParent)do{t+=i.offsetLeft,s+=i.offsetTop}while(i=i.offsetParent);var n=e.pageX-t,o=e.pageY-s;locale.quee.mouse_position=[n,o],__callbacks.mouse_move(n,o)}function __onClick(e){var i=document.getElementById("quee_canvas"),t=0,s=0;if(i.offsetParent)do{t+=i.offsetLeft,s+=i.offsetTop}while(i=i.offsetParent);var n=e.pageX-t,o=e.pageY-s;for(spritenum in __callbacks.mouse_click([n,o]),locale.quee.mouse_clicked=!1,locale.quee.last_mouse_click=[n,o],__sprites){sprite=__sprites[spritenum];const[e,i,t,s]=__get_dims(sprite),[c,_,a,l]=[n,o,1,1];sprite.click&&(c>s+e||e>l+c||_>t+i||i>a+_||sprite.__onclick_callback([n,o]))}}function __get_dims(e){var i=e.image.height*e.scale,t=e.image.width*e.scale*e.image.height/e.image.width;return[e.x,e.y,t,i]}function __collided(e,i){const[t,s,n,o]=__get_dims(e),[c,_,a,l]=__get_dims(i);return!(c>o+t||t>l+c||_>n+s||s>a+_)}function __if_collision(e){var i=[];for(sprite in e)if(0!=e[sprite].clip)for(osprites in e){if(osprites==sprite)break;0==e[osprites].clip||__collided(e[sprite],e[osprites])&&i.push([e[sprite],e[osprites]])}return i}document.getElementById("quee_canvas").width=window.innerWidth,document.getElementById("quee_canvas").height=window.innerHeight,document.onkeydown=__key_callback,document.getElementById("quee_canvas").addEventListener("mouseup",__onClick,!1),document.getElementById("quee_canvas").addEventListener("mousedown",function(){locale.quee.mouse_clicked=!0},!1),document.getElementById("quee_canvas").addEventListener("mousemove",__onMove,!1);const quee_window={Console:{Error:function(e){console.error("[quee.js error] "+e)},Warning:function(e){console.warn("[quee.js warning] "+e)},Info:function(e){console.info("[quee.js info] "+e)}},Cookies:{SetCookie:function(e,i){document.cookie=e+"="+i+";"},GetCookie:function(e){for(var i=e+"=",t=decodeURIComponent(document.cookie).split(";"),s=0;s<t.length;s++){for(var n=t[s];" "==n.charAt(0);)n=n.substring(1);if(0==n.indexOf(i))return n.substring(i.length,n.length)}return""}},Title:function(e){document.title=e}},quee_image={LoadImage:function(e,i,t){i in __images&&quee_window.Console.Warning("The image: "+i+" already exists");var s=new Image;s.setAttribute("crossOrigin","anonymous"),s.onload=function(){__images[i]=s,quee_window.Console.Info("The image: "+i+" is loaded"),t(i,e)},s.src=e}},quee_input={Key:{Bind:function(e,i){e in __callbacks.key&&quee_window.Console.Warning("The keybind: "+e+" is already set."),__callbacks.key[e]=i},Up:"ArrowUp",Down:"ArrowDown",Left:"ArrowLeft",Right:"ArrowRight"},Mouse:{Move:function(e){__callbacks.mouse_move=e},Click:function(e){__callbacks.mouse_click=e}}},quee_ui={__canvas:document.getElementById("quee_canvas"),Move:{Up:function(e,i,t=10){return function(){e.y-=t,e.__backward=[0,t],i.draw()}},Down:function(e,i,t=10){return function(){e.y+=t,e.__backward=[0,-t],i.draw()}},Right:function(e,i,t=10){return function(){e.x+=t,e.__backward=[-t,0],i.draw()}},Left:function(e,i,t=10){return function(){e.x-=t,e.__backward=[t,0],i.draw()}}},Delete:function(e,i){return function(){e.__exist=!1,i.draw()}},Sprite:function(e,i,t={}){"scale"in t||(t.scale=1),"clip"in t||(t.clip=!0),"click"in t||(t.click=!0),this.x=50,this.y=50,this.scale=t.scale,this.clip=t.clip,this.click=t.click,this.__collision_callback=function(){},this.__onclick_callback=function(){},this.__backward=[0,0],this.__world=e,this.__exist=!0,this.__type="sprite",i in __images?this.image=__images[i]:quee_window.Console.Error("The image: "+i+" does not exist!"),this.__world.__add(this),__sprites.push(this),this.Collision=function(e){this.__collision_callback=e},this.ChangeImage=function(e){e in __images?this.image=__images[e]:quee_window.Console.Error("The image: "+e+" does not exist!")},this.OnClick=function(e){this.click?this.__onclick_callback=e:quee_window.Console.Error("Cannot assign OnClick property, object cannot be clicked.")},this.Dims=function(){var e=this.image.height*this.scale;return[this.image.width*this.scale*this.image.height/this.image.width,e]}},Text:function(e,i,t={}){"size"in t||(t.size=30),"font"in t||(t.font="Arial"),this.x=50,this.y=50,this.text=i,this.size=t.size,this.font=t.font,this.__exist=!0,this.__world=e,this.__type="text",this.clip=!1,this.click=!1,this.__world.__add(this)},World:function(){quee_window.Console.Info("using quee.js version: "+VERSION),this.__sprites=[],this.x=0,this.y=0,this.__add=function(e){this.__sprites.push(e),quee_window.Console.Info("Loaded: "+e.__type+" object")},this.draw=function(){this.clear(),ctx=quee_ui.__canvas.getContext("2d");var e=__if_collision(this.__sprites);for(collision in e)e[collision][0].__collision_callback(e[collision][1]),e[collision][0].x+=e[collision][0].__backward[0],e[collision][0].y+=e[collision][0].__backward[1],e[collision][1].__collision_callback(e[collision][0]),e[collision][1].x+=e[collision][1].__backward[0],e[collision][1].y+=e[collision][1].__backward[1];var i=[];for(spritenum in this.__sprites)if(0==this.__sprites[spritenum].__exist);else if(i.push(this.__sprites[spritenum]),sprite=this.__sprites[spritenum],"text"==sprite.__type)ctx.font=sprite.size.toString()+"px "+sprite.font,ctx.fillText(sprite.text,sprite.x+this.x,sprite.y+this.y);else{const[e,i,t,s]=__get_dims(sprite);(e>quee_ui.__canvas.width+0||0>s+e||i>quee_ui.__canvas.height+0||0>t+i)&&(sprite.__collision_callback(quee_ui.__canvas),sprite.x+=sprite.__backward[0],sprite.y+=sprite.__backward[1]),ctx.drawImage(sprite.image,sprite.x+this.x,sprite.y+this.y,sprite.image.height*sprite.scale,sprite.image.width*sprite.scale*sprite.image.height/sprite.image.width)}this.__sprites=i},this.clear=function(){ctx=quee_ui.__canvas.getContext("2d"),ctx.clearRect(0,0,quee_ui.__canvas.width,quee_ui.__canvas.height)}}};