var __key_callbacks={},__images={},__sprites=[],locale={quee:{last_mouse_click:[],last_pressed_key:""}},VERSION="0.2";function __key_callback(i){locale.quee.last_pressed_key=i.key,i.key in __key_callbacks&&__key_callbacks[i.key](i.key),"~~"in __key_callbacks&&__key_callbacks["~~"](i.key)}function __onClick(i){var e=document.getElementById("quee_canvas"),t=0,s=0;if(e.offsetParent)do{t+=e.offsetLeft,s+=e.offsetTop}while(e=e.offsetParent);var n=i.pageX-t,o=i.pageY-s;for(spritenum in locale.quee.last_mouse_click=[n,o],__sprites){sprite=__sprites[spritenum];const[i,e,t,s]=__get_dims(sprite),[_,c,a,r]=[n,o,1,1];sprite.click&&(_>s+i||i>r+_||c>t+e||e>a+c||sprite.__onclick_callback([n,o]))}}function __get_dims(i){var e=i.image.height*i.scale,t=i.image.width*i.scale*i.image.height/i.image.width;return[i.x,i.y,t,e]}function __collided(i,e){const[t,s,n,o]=__get_dims(i),[_,c,a,r]=__get_dims(e);return!(_>o+t||t>r+_||c>n+s||s>a+c)}function __if_collision(i){var e=[];for(sprite in i)if(0!=i[sprite].clip)for(osprites in i){if(osprites==sprite)break;0==i[osprites].clip||__collided(i[sprite],i[osprites])&&e.push([i[sprite],i[osprites]])}return e}document.getElementById("quee_canvas").width=window.innerWidth,document.getElementById("quee_canvas").height=window.innerHeight,document.onkeydown=__key_callback,document.getElementById("quee_canvas").addEventListener("mouseup",__onClick,!1);const quee_window={Console:{Error:function(i){console.error("[quee.js error] "+i)},Warning:function(i){console.warn("[quee.js warning] "+i)},Info:function(i){console.info("[quee.js info] "+i)}},Cookies:{SetCookie:function(i,e){document.cookie=i+"="+e+";"},GetCookie:function(i){for(var e=i+"=",t=decodeURIComponent(document.cookie).split(";"),s=0;s<t.length;s+=1){for(var n=t[s];" "==n.charAt(0);)n=n.substring(1);if(0==n.indexOf(e))return n.substring(e.length,n.length)}return""}},Title:function(i){document.title=i}},quee_image={LoadImage:function(i,e,t){e in __images&&quee_window.Console.Warning("The image: "+e+" already exists");var s=new Image;s.setAttribute("crossOrigin","anonymous"),s.onload=function(){__images[e]=s,quee_window.Console.Info("The image: "+e+" is loaded"),t(e,i)},s.src=i}},quee_input={Key:{Bind:function(i,e){i in __key_callbacks&&quee_window.Console.Warning("The keybind: "+i+" is already set."),__key_callbacks[i]=e},Up:"ArrowUp",Down:"ArrowDown",Left:"ArrowLeft",Right:"ArrowRight"}},quee_ui={__canvas:document.getElementById("quee_canvas"),Move:{Up:function(i,e,t=10){return function(){i.y-=t,i.__backward=[0,t],e.draw()}},Down:function(i,e,t=10){return function(){i.y+=t,i.__backward=[0,-t],e.draw()}},Right:function(i,e,t=10){return function(){i.x+=t,i.__backward=[-t,0],e.draw()}},Left:function(i,e,t=10){return function(){i.x-=t,i.__backward=[t,0],e.draw()}}},Delete:function(i,e){return function(){i.__exist=!1,e.draw()}},Sprite:function(i,e,t={}){"scale"in t||(t.scale=1),"clip"in t||(t.clip=!0),"click"in t||(t.click=!0),this.x=50,this.y=50,this.scale=t.scale,this.clip=t.clip,this.click=t.click,this.__collision_callback=function(){},this.__onclick_callback=function(){},this.__backward=[0,0],this.__world=i,this.__exist=!0,this.__type="sprite",e in __images?this.image=__images[e]:quee_window.Console.Error("The image: "+e+" does not exist!"),this.__world.__add(this),__sprites.push(this),this.Collision=function(i){this.__collision_callback=i},this.ChangeImage=function(i){i in __images?this.image=__images[i]:quee_window.Console.Error("The image: "+i+" does not exist!")},this.OnClick=function(i){this.click?this.__onclick_callback=i:quee_window.Console.Error("Cannot assign OnClick property, object cannot be clicked.")}},Text:function(i,e,t={}){"size"in t||(t.size=30),"font"in t||(t.font="Arial"),this.x=50,this.y=50,this.text=e,this.size=t.size,this.font=t.font,this.__exist=!0,this.__world=i,this.__type="text",this.clip=!1,this.click=!1,this.__world.__add(this)},World:function(){quee_window.Console.Info("quee.js version: "+VERSION),this.__sprites=[],this.x=0,this.y=0,this.__add=function(i){this.__sprites.push(i)},this.draw=function(){this.clear(),ctx=quee_ui.__canvas.getContext("2d");var i=__if_collision(this.__sprites);for(collision in i)i[collision][0].__collision_callback(i[collision][1]),i[collision][0].x+=i[collision][0].__backward[0],i[collision][0].y+=i[collision][0].__backward[1],i[collision][1].__collision_callback(i[collision][0]),i[collision][1].x+=i[collision][1].__backward[0],i[collision][1].y+=i[collision][1].__backward[1];var e=[];for(spritenum in this.__sprites)if(0==this.__sprites[spritenum].__exist);else if(e.push(this.__sprites[spritenum]),sprite=this.__sprites[spritenum],"text"==sprite.__type)ctx.font=sprite.size.toString()+"px "+sprite.font,ctx.fillText(sprite.text,sprite.x+this.x,sprite.y+this.y);else{const[i,e,t,s]=__get_dims(sprite);(i>quee_ui.__canvas.width+0||0>s+i||e>quee_ui.__canvas.height+0||0>t+e)&&(sprite.__collision_callback(quee_ui.__canvas),sprite.x+=sprite.__backward[0],sprite.y+=sprite.__backward[1]),ctx.drawImage(sprite.image,sprite.x+this.x,sprite.y+this.y,sprite.image.height*sprite.scale,sprite.image.width*sprite.scale*sprite.image.height/sprite.image.width)}this.__sprites=e},this.clear=function(){ctx=quee_ui.__canvas.getContext("2d"),ctx.clearRect(0,0,quee_ui.__canvas.width,quee_ui.__canvas.height)}}};